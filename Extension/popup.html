<!DOCTYPE html>
    <head>
        <style >
            body {
                margin: 0;
                background-color: #208EF1;
                color: white;
                text-align: center;
                /*Secondary #4EAFF7*/
            }
            h2 {
                background-color: #4eaff7;
                text-align: center;
                margin-top: 0;
                padding-bottom: 2px;
            }
            h3 > span {
                background-color: #4eaff7;
                text-align: center;
                margin-top: 0;
                padding-bottom: 2px;
                padding: 0 10px 2px 10px
            }
            input {
                background-color: #4eaff7;
                color: white;
                border: none;
                padding: 5px 10px;
            }
            select {
                background-color: #4eaff7;
                color: white;
                border: none;
                padding: 5px 10px;
                width: 100%;
            }
            input::placeholder{
                color: white;
            }
            input[type="checkbox"]{
                margin-right: 5px;
            }
            button {
                border: 4px solid #4eaff7;
                border-radius: 4px;
                padding: 5px 10px;
                margin-top: 20px;
                margin-bottom: 10px;
            }
            .header {
                border-bottom: 5px solid #4EAFF7;
                padding: 5px 15px;
                display: flex;
                justify-content: space-between;
            }
                .header a{
                    cursor: pointer;
                    flex-grow: 1;
                    padding-bottom: 5px;
                    margin-bottom: -7px;
                }
                .header a.active{
                    border-bottom: 2px solid #4ee7f7;
                }
            .box {
                border-bottom: 5px solid #4EAFF7;
                border-radius: 20px;
                padding: 10px 15px;
            }
            .matched {
                border-bottom: 5px solid #4EAFF7;
                padding: 15px 15px 10px 15px;
            }
            .page-box {
                border: 4px solid #4EAFF7;
                border-radius: 20px;
                display: flex;
                justify-content: space-between;
                min-height: 30px;
                align-items: center;
                transition: 0.5s border-color;
                margin-top: -4px;
            }
                .page-box.active {
                    border-color: #4ee7f7;
                    z-index: 2;
                }
                .page-box .checkbox{
                    position: relative;
                    width: 30px;
                    align-self: stretch;
                    border-right: 2px solid #4eaff7;
                    border-radius: 25px;
                    margin-left: -1px;
                    padding-left: 1px;
                    margin-top: -1px;
                    margin-bottom: -1px;
                    margin-right: 10px;
                    transition: 0.5s background-color, 0.5s border-color;
                }
                    .page-box.active .checkbox{
                        border-color: #4ee7f7;
                        background-color: #4ee7f7;
                    }
                    .page-box .checkbox img {
                        display: block;
                        position: absolute;
                        top: 50%;
                        left: 50%;
                        margin-left: -9px;
                        margin-top: -9px;
                    }
                .page-box .img{
                    width: 23px;
                }
                    .page-box .img img{
                        display: block;
                        max-height: 23px;
                    }
                .page-box .text{
                    flex-grow: 1;
                    text-align: left;
                    padding: 5px 10px;
                }
            .settings-box {
                border: 2px solid #4EAFF7;
                text-align: left;
                padding: 10px 20px;
                margin-top: -20px;
                padding-top: 30px;
                border-top: 0;
                transition: 0.5s background-color, 0.5s border-color;
            }
                .page-box-outer.active .settings-box{
                    border-color: #4ee7f7;
                }
                .settings-box > *{
                    margin-bottom: 10px;
                }
                .settings-box input{
                    vertical-align: middle;
                }
            .perm {

            }
                .perm .permP {
                    border: 1px solid #4EAFF7;
                    border-radius: 25px;
                    padding: 3px 10px;
                    padding-left: 30px;
                    text-align: left;
                }
                    .perm .permP span {
                        float: right;
                    }

        </style>
    </head>
    <body style="width: 250px;">
        <div id="app">
            <div class="header">
                <a @click="active='home'" :class="{active: active==='home'}">Home</a>
                <a @click="active='active'" :class="{active: active==='active'}">Active</a>
                <a @click="active='blocked'" :class="{active: active==='blocked'}">Blocked</a>
                <a @click="active='search'" :class="{active: active==='search'}">Search</a>
            </div>
            <div class="section" v-if="active==='home'">
                <div class="perm box" v-if="missingPermissions.length || sync.missingIframes.length">
                    <h2>Missing Permissions</h2>
                    <div v-if="missingPermissions.length">
                        <h3><span>Pages</span></h3>
                        <div v-for="iframe in missingPermissions" :key="iframe" class="permP">
                            {{getHostname(iframe)}}
                        </div>
                        <br>
                    </div>

                    <div v-if="sync.missingIframes.length">
                        <h3><span>Iframes</span></h3>
                        <div v-for="iframe in sync.missingIframes" :key="iframe" class="permP">
                            {{getHostname(iframe)}} <span @click="blockIframe(iframe)">X</span>
                        </div>
                    </div>

                    <div class="missingPermission" v-if="missingPermissions.length || sync.missingIframes.length">
                        <button id="request" @click="requestPermissions">Request Permissions</button>
                    </div>
                </div>
                <div class="matched">
                    <div v-if="!matchedPages.length">No presence for this page found</div>
                    <div v-for="page in matchedPages" :key="page.service" class="page-box-outer" :class="{active: activePages.isPageActive(page)}">
                        <div class="page-box" @click="togglePage(page, true)" :class="{active: activePages.isPageActive(page)}">
                            <div class="checkbox">
                                <img v-if="activePages.isPageActive(page)" src="./vendor/delete-black-18dp.svg" width="18" height="18">
                                <img v-else src="./vendor/get_app-black-18dp.svg" width="18" height="18">
                            </div>
                            <div class="img">
                                <img :src="page.logo" width="23">
                            </div>
                            <div class="text">
                                {{page.service}}

                            </div>
                        </div>
                        <div v-if="page.settings && page.settings.length && filterSettings(page.settings).length" class="settings-box">
                            <div v-for="setting in filterSettings(page.settings)" :key="setting.id">
                                <div v-if="typeof setting.value === 'boolean'">
                                    <input type="checkbox" :checked="setting.value"
                                        @change="updateSetting(page, setting.id, $event.target.checked)" />
                                    {{setting.title}}
                                </div>
                                <div v-if="typeof setting.value === 'string'">
                                    {{setting.title}}
                                    <input type="text" :value="setting.value" spellcheck="false"
                                        @input="updateSetting(page, setting.id, $event.target.value)" :ref="setting.id"
                                        :placeholder="setting.placeholder" />
                                </div>
                                <div v-if="typeof setting.value === 'number'">
                                    {{setting.title}}
                                    <select @change="updateSetting(page, setting.id, parseInt($event.target.value))">
                                        <option v-for="(opt, key) in setting.values" :key="key" :value="key" :selected="key === setting.value">{{opt}}
                                        </option>
                                    </select>
                                </div>




                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="section" v-if="active==='active'">
                <div class="matched">
                    <h2>Active Presences</h2>
                    <br>
                    <div class="page-box" v-for="page in enabledPages" :key="page.service" @click="togglePage(page)"
                        :class="{active: activePages.isPageActive(page)}">
                        <div class="checkbox">
                            <img v-if="activePages.isPageActive(page)" src="./vendor/delete-black-18dp.svg" width="18" height="18">
                            <img v-else src="./vendor/get_app-black-18dp.svg" width="18" height="18">
                        </div>
                        <div class="img">
                            <img :src="page.logo" width="23">
                        </div>
                        <div class="text">
                            {{page.service}}
                        </div>
                    </div>
                    <div class="perm box" v-if="sync.allowedIframes.length">
                        <div>
                            <h3><span>Iframes</span></h3>
                            <div v-for="iframe in sync.allowedIframes" :key="iframe" class="permP">
                                {{getHostname(iframe)}} <span @click="blockIframe(iframe)">X</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="section" v-if="active==='blocked'">
                <div class="perm box" v-if="sync.blockedIframes.length">
                    <h2>Blocked Domains</h2>

                    <div v-if="sync.blockedIframes.length">
                        <h3><span>Iframes</span></h3>
                        <div v-for="iframe in sync.blockedIframes" :key="iframe" class="permP">
                            {{getHostname(iframe)}} <span @click="deBlockIframe(iframe)">X</span>
                        </div>
                    </div>
                </div>
                <div v-else>
                    <h3><span>No blocked domains</span></h3>
                </div>
            </div>
            <div class="section" v-if="active==='search'">
                <input v-model="searchWord" placeholder="Search"/>
                <div class="matched">
                    <div class="page-box" v-for="page in filteredPages" :key="page.service" @click="togglePage(page)"
                        :class="{active: activePages.isPageActive(page)}">
                        <div class="checkbox">
                            <img v-if="activePages.isPageActive(page)" src="./vendor/delete-black-18dp.svg" width="18" height="18">
                            <img v-else src="./vendor/get_app-black-18dp.svg" width="18" height="18">
                        </div>
                        <div class="img">
                            <img :src="page.logo" width="23">
                        </div>
                        <div class="text">
                            {{page.service}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="./vendor/vue.js"></script>
        <script src="./Pages/pages.js"></script>
        <script src="./popup.js"></script>
    </body>
</html>